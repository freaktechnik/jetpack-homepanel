language: android
android:
  components:
  - platform-tools
  - tools
  - android-17
  - sys-img-armea
before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- cd /tmp
- mkdir sdcard
- mksdcard -l jetpackSdCard 1024M sdcard/jetpacksdcard.img
- echo no | android create avd --force -n jetpack -t android-17 --abi armeabi-v7a
- emulator -avd jetpack -sdcard sdcard/jetpacksdcard.img -no-audio -gpu on -no-boot-anim
  -noskin &
- android-wait-for-emulator
- adb shell input keyevent 82 &
- adb shell input keyevent 82 &
- wget -O fennec.apk https://ftp.mozilla.org/pub/mozilla.org/mobile/nightly/latest-mozilla-central-android-api-11/fennec-40.0a1.multi.android-arm.apk
- adb install fennec.apk
- cd $TRAVIS_BUILD_DIR
- npm install jpm-mobile -g
- export JPM_FIREFOX_BINARY=fennec
- export JPM_ADB_PATH=/usr/local/android-sdk/platform-tools/adb
script:
- jpm-mobile test -v --adb $JPM_ADB_PATH -b $JPM_FIREFOX_BINARY
deploy:
  provider: npm
  email: martin@humanoids.be
  api_key:
    secure: DNgnzqrmCBaER+yEvGCAeRJLL9BeBjfvZC/K+gos/QUzQ6S/EaDjSGRJGBxarW0k5EbGL9LkrgBy3M3nXzHsLCDcS4ewvzKL4X6jH2qfIPvQc6fLu/lKy9yBrRfyaiG8fKVR+3Vm7YlZ940OCtiLkEf1Z+ezPY5TJdjKJEmjv2Q=
